{"body":"<pre><code class=\"lang-csharp\"><span class=\"hljs-comment\">//Implements IPayment</span>\n<span class=\"hljs-keyword\">try</span> {\n  <span class=\"hljs-keyword\">var</span> paymentRequestValidator = PaymentRequestValidatorFactory.Create(request.body);\n\n  <span class=\"hljs-keyword\">var</span> paymentRequest = paymentRequestValidator.validate();\n\n  <span class=\"hljs-keyword\">var</span> paymentProviderPayloadAdapter = PaymentProviderPayloadAdapterFactory.Create(paymentRequest.type);\n\n  <span class=\"hljs-keyword\">var</span> paymentProvider = PaymentProviderFactory.Create(paymentRequest, config); <span class=\"hljs-comment\">//Implements IProviderFactory</span>\n\n  <span class=\"hljs-keyword\">var</span> paymentProviderResponse = paymentProvider.Pay(paymentProviderPayloadAdapter.adaptRequest(paymentRequest));\n\n  <span class=\"hljs-keyword\">var</span> adaptedResponse = paymentProviderPayloadAdapter.adaptRequest(paymentProviderResponse);\n\n} <span class=\"hljs-keyword\">catch</span> (ConnectException e) {\n\n} <span class=\"hljs-keyword\">catch</span> (OutOfFundsException e) {\n\n} <span class=\"hljs-keyword\">catch</span> (ExpiredCCException e) {\n\n} <span class=\"hljs-keyword\">catch</span> (AvsException e) {\n\n} <span class=\"hljs-keyword\">catch</span> (AddressMissMatchException e) {\n\n} <span class=\"hljs-keyword\">catch</span> (InvalidCCForAccountException e) {\n\n} <span class=\"hljs-keyword\">catch</span> (InvalidCredentialsException e) {\n} <span class=\"hljs-keyword\">catch</span> (<span class=\"hljs-keyword\">Exception</span> e) {\n  <span class=\"hljs-comment\">// Handle unknown Exception</span>\n} <span class=\"hljs-keyword\">finally</span> {\n  <span class=\"hljs-comment\">// Do some clean up here</span>\n}\n</code></pre>\n<blockquote>\n<p>Yes this code can be made a bit cleaner</p>\n<p>Not all exceptions should be handle here and not all code live at the same level.</p>\n</blockquote>\n","updatedAt":"2017-04-07T04:42:56.000Z"}